import{a as H,b as x,u as V}from"./@vueuse-e4ab8daf.js";import{c as P}from"./calendar-43e64fc0.js";import{r as L}from"./@rive-app-23332047.js";import{d as z}from"./lodash-c398c9e4.js";import{a as Q}from"./TabMenu.vue_vue_type_style_index_0_scss_true_lang-0943e4ce.js";import{_ as $,t as I}from"./index-40f8ec66.js";import{r as k,t as G,A as p,v as l,J as d,C as e,z as m,u as g,F as N,I as h,G as C,H as E,y as D,L as S,M as w,P as O,c as J,x as b,Q as q}from"./@vue-ba2132af.js";import{u as K}from"./vuex-d57e3de0.js";import{F as M,G as U,H as X,J as Z}from"./@ionic-9d55a180.js";import"./dayjs-3dd13c04.js";import"./@awesome-cordova-plugins-365971a8.js";import"./@capacitor-6a3f6ab0.js";import{S as T}from"./search-eattd-tlsn-std-info-6770e658.js";import{S as tt}from"./search-eattd-open-sche-c974f3c2.js";import{a as f}from"./search-wifi-rcptn-hist-886e94a5.js";import{r as A,Q as j,b as W,O as F,p as R}from"./OTP_icon-3cf6eea2.js";import{S as v}from"./search-eattd-open-rpst-staff-info-133ce700.js";import"./vue-router-0104e6e6.js";import"./axios-b6718f5e.js";import"./@stencil-18a6d1f6.js";import"./ionicons-2e812d46.js";import"./tslib-f1640d2e.js";import"./rxjs-6f486a4b.js";const st=t=>(C("data-v-5f65ca0f"),t=t(),E(),t),et={class:"main__today"},ot={class:"time_wrapper"},nt={class:"today__title"},at={class:"today__year"},ct={class:"today__date"},it={class:"today__time"},rt=st(()=>e("span",{class:"time__meridiem"},null,-1)),lt={class:"bg-rive"},dt={__name:"MainToday",setup(t,{expose:s}){const i=H(),c=i.value.getFullYear(),o=x(i,"MM.DD (ddd)"),n=x(i,"HH:mm:ss"),r=k("canvas"),u=z(()=>{const _=new L.Rive({canvas:r.value,src:"/chacha.riv",autoplay:!0,layout:new L.Layout({alignment:L.Alignment.BottomRight}),onLoad:()=>{_.resizeDrawingSurfaceToCanvas()}})},20);return G(()=>{u()}),s({rive:u}),(_,a)=>{const y=p("ion-icon");return l(),d("div",et,[e("div",ot,[e("div",nt,[m(y,{src:g(P)},null,8,["src"]),N("TODAY")]),e("span",at,h(g(c)),1),e("strong",ct,h(g(o)),1),e("div",it,[rt,N(h(g(n)),1)])]),e("div",lt,[e("canvas",{ref_key:"canvas",ref:r,width:"339",height:"237"},null,512)])])}}},ht=$(dt,[["__scopeId","data-v-5f65ca0f"]]),_t={name:"stdnt-class-status",components:{IonSkeletonText:M},data(){return{classList:[],search:new T,searchEattdOpenSche:new tt,semesterInfo:{},checkDate:f().checkDate,yy:f().yy,reloadIcon:A,isLoading:!0}},setup(){return{QRIcon:j,beaconIcon:W,OTPIcon:F}},computed:{user(){return this.$store.state.signIn.user}},methods:{classDetail(t){const s=new T;s.openSbjtNo=t.openSbjtNo,s.stdNo=t.stdNo,s.openYy=t.openYy,s.openDclss=t.openDclss,s.openShtmCd=t.openShtmCd,s.checkDate=this.checkDate,s.staffNo=t.staffNo,s.fromTm=t.fromTm,this.$store.commit("stdnt/setSearch",s),this.$router.push("stdnt/att/class")},async getSemesterInfo(){try{this.isLoading=!0,this.checkDate=f().checkDate,this.yy=f().yy,this.searchEattdOpenSche.orgnClsfCd=this.user.orgnClsfCd,this.searchEattdOpenSche.checkDate=this.checkDate,this.searchEattdOpenSche.yy=this.yy;const t=await this.$store.dispatch("common/getSemesterInfo",this.searchEattdOpenSche);this.semesterInfo=t.data.resultData,await this.setWeekList(),await this.getLectureList()}finally{this.isLoading=!1}},async refresh(){const t=await R();this.getSemesterInfo().finally(()=>{t.dismiss(),I("수강중인 수업을 조회했습니다.")})},async getLectureList(){if(this.user.mbrNo!==null){this.search.stdNo=this.user.mbrNo,this.search.openYy=this.yy,this.search.openShtmCd=this.semesterInfo.shtmCd,this.search.checkDate=this.checkDate;let t=[],s=[];try{t=(await this.$store.dispatch("stdnt/getLectureList",this.search)).data.resultData;for(let c=0;c<t.length;c++){const o=t[c],n=new v;if(n.ltStaffNo=o.staffNo,n.openYy=o.openYy,n.checkDate=this.checkDate,n.openShtmCd=o.openShtmCd,n.openSbjtNo=o.openSbjtNo,n.openDclss=o.openDclss,n.fromTm=o.fromTm,(await this.$store.dispatch("profsr/getLectureInfo",n)).data.resultData==null&&s.push(c),c==t.length-1){const u=t.filter((_,a)=>!s.includes(a));this.classList=u.filter(_=>this.timeCheck(_.clsTm))}}}catch(i){I("수강중인 수업 조회실패")}}},async setWeekList(){const t=this.semesterInfo.ltFromDt,s=this.semesterInfo.ltToDt,c=(await this.$store.dispatch("common/getWeekList",{ltFromDt:t,ltToDt:s})).data.resultData,o=Object.keys(c);for(let n=0;n<o.length;n++){const r=o[n];c[r].startDate<=this.searchEattdOpenSche.checkDate&&c[r].endDate>=this.searchEattdOpenSche.checkDate&&this.$store.commit("common/setWeek",c[r])}},getAttTypeNm(t){return t.attDiv==null?{text:"미출석",status:"status5"}:Q(t.attDiv)},timeCheck(t){const s=new Date,i=String(s.getHours()),c=s.getMinutes()<10?"0"+s.getMinutes():s.getMinutes(),o=Number(i+c),n=t.split("~")[1].trim().split(":")[0]+t.split("~")[1].trim().split(":")[1];return!(Number(n)<o)}}},Y=t=>(C("data-v-f093739d"),t=t(),E(),t),mt={class:"main__class"},ut={class:"refresh_wrap sub-title"},pt=Y(()=>e("span",null,"수강중인 수업",-1)),ft={key:0},yt={class:"class__list"},gt={class:"class__item"},kt={class:"class__state"},vt={class:"class__infos"},Dt={key:1},St={key:0},wt=["onClick"],$t={class:"class__argumnet"},Lt={class:"class__state"},It={class:"state__text"},xt={class:"class__infos"},Nt={class:"class__time"},bt={class:"class__name"},Tt={class:"class__place"},Ct={key:1},Et=Y(()=>e("div",{style:{color:"#888888",padding:"18vh 0","text-align":"center"}},[e("strong",null,"수강중인 수업이 없습니다.")],-1)),Ot=[Et];function Mt(t,s,i,c,o,n){const r=p("ion-icon"),u=p("ion-button"),_=p("ion-skeleton-text");return l(),d("div",null,[e("div",mt,[e("div",ut,[pt,m(u,{fill:"clear",onClick:s[0]||(s[0]=a=>n.refresh()),shape:"round"},{default:D(()=>[m(r,{icon:o.reloadIcon,slot:"end"},null,8,["icon"])]),_:1})]),o.isLoading?(l(),d("div",ft,[e("ul",yt,[(l(),d(S,null,w(3,a=>e("li",{key:"skel_".concat(a),class:"is--loading"},[e("div",gt,[e("div",kt,[m(_,{animated:!0,style:{width:"60px",height:"60px"}})]),e("div",vt,[m(_,{animated:!0,style:{width:"80%","margin-bottom":"8px"}}),m(_,{animated:!0,style:{width:"80%",height:"20px","margin-bottom":"8px"}}),m(_,{animated:!0,style:{width:"60%"}})])])])),64))])])):(l(),d("div",Dt,[o.classList.length>0?(l(),d("ul",St,[(l(!0),d(S,null,w(o.classList,(a,y)=>(l(),d("li",{key:y,onClick:B=>n.classDetail(a),class:O(["class_item",n.getAttTypeNm(a).status])},[e("div",$t,[e("div",Lt,[e("span",It,h(n.getAttTypeNm(a).text),1)]),e("div",xt,[e("div",Nt," ("+h(a.clsTm)+") "+h(a.openSbjtNo),1),e("div",bt,h(a.sbjtNm)+" ("+h(a.staffNm)+")",1),e("div",Tt,h(a.ltBldgNm)+" "+h(a.ltrmNm),1)])])],10,wt))),128))])):(l(),d("ul",Ct,Ot))]))])])}const At=$(_t,[["render",Mt],["__scopeId","data-v-f093739d"]]),jt={name:"profsr-today-class",components:{IonSkeletonText:M},data(){return{searchEattdOpenRpstStaffInfo:new v,lectureList:[],semesterInfo:{},checkDate:f().checkDate,yy:f().yy,isLoading:!0}},computed:{user(){return this.$store.state.signIn.user}},setup(){return{QRIcon:j,beaconIcon:W,OTPIcon:F,reloadIcon:A}},methods:{async getLectureList(){this.searchEattdOpenRpstStaffInfo.ltStaffNo=this.user.mbrNo,this.searchEattdOpenRpstStaffInfo.openYy=this.yy,this.searchEattdOpenRpstStaffInfo.checkDate=this.checkDate;const t=await this.$store.dispatch("profsr/getLectureList",this.searchEattdOpenRpstStaffInfo),{resultData:s}=t.data,i=s.filter(o=>this.timeCheck(o.fromTm,o.toTm).state==="status1"),c=s.filter(o=>this.timeCheck(o.fromTm,o.toTm).state!=="status1");c.push(...i),this.lectureList=c,this.setWeekList()},getLecture(t){const s=new v;s.ltStaffNo=t.ltStaffNo,s.openYy=t.openYy,s.checkDate=this.checkDate,s.openShtmCd=t.openShtmCd,s.openSbjtNo=t.openSbjtNo,s.openDclss=t.openDclss,s.fromTm=t.fromTm,this.$store.dispatch("profsr/getLecture",s).then(i=>{i==!0&&this.$router.push("/cnu/profsr/att/class").catch(()=>{})})},async refresh(){const t=await R();this.getSemesterInfo().finally(()=>{t.dismiss(),I("강의중인 수업을 조회했습니다.")})},async getSemesterInfo(){try{this.isLoading=!0,this.checkDate=f().checkDate,this.yy=f().yy;const t=new v;t.checkDate=this.checkDate,t.yy=this.yy;const s=await this.$store.dispatch("common/getSemesterList",t);this.semesterInfo=s.data.resultData[0],await this.getLectureList()}finally{this.isLoading=!1}},timeFormat(t){return t.slice(0,2)+":"+t.slice(2,4)},timeCheck(t,s){const i=new Date,c=String(i.getHours()),o=i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes(),n=Number(c+o),r=Number(t),u=Number(s);if(r>n)return{text:"수업전",state:"status4"};if(r<=n&&u>=n)return{text:"수업중",state:"status3"};if(u<n)return{text:"수업 완료",state:"status1"}},async setWeekList(){const t=this.semesterInfo.ltFromDt,s=this.semesterInfo.ltToDt,c=(await this.$store.dispatch("common/getWeekList",{ltFromDt:t,ltToDt:s})).data.resultData,o=Object.keys(c);for(let n=0;n<o.length;n++){const r=o[n];c[r].startDate<=this.checkDate&&c[r].endDate>=this.checkDate&&this.$store.commit("common/setWeek",c[r])}}}},Wt={class:"main__class"},Ft={class:"refresh_wrap sub-title"},Rt=e("span",null,"강의 중인 수업",-1),Yt={key:0},Bt={class:"class__list"},Ht={class:"class__item"},Vt={class:"class__state"},Pt={class:"class__infos"},zt={key:1},Qt={key:0},Gt=["onClick"],Jt={class:"class__argumnet"},qt={class:"class__state"},Kt={class:"state__text"},Ut={class:"class__infos"},Xt={class:"class__time"},Zt={class:"class__name"},ts={class:"class__place"},ss={key:1},es=e("div",{style:{color:"#888888",padding:"18vh 0","text-align":"center"}},[e("strong",null,"강의중인 수업이 없습니다.")],-1),os=[es];function ns(t,s,i,c,o,n){const r=p("ion-icon"),u=p("ion-button"),_=p("ion-skeleton-text");return l(),d("div",Wt,[e("div",Ft,[Rt,m(u,{fill:"clear",onClick:s[0]||(s[0]=a=>n.refresh()),shape:"round"},{default:D(()=>[m(r,{icon:c.reloadIcon,slot:"end"},null,8,["icon"])]),_:1})]),o.isLoading?(l(),d("div",Yt,[e("ul",Bt,[(l(),d(S,null,w(3,a=>e("li",{key:"skel_".concat(a),class:"is--loading"},[e("div",Ht,[e("div",Vt,[m(_,{animated:!0,style:{width:"40px",height:"40px"}})]),e("div",Pt,[m(_,{animated:!0,style:{width:"80%","margin-bottom":"8px"}}),m(_,{animated:!0,style:{width:"80%",height:"20px","margin-bottom":"8px"}}),m(_,{animated:!0,style:{width:"60%","margin-bottom":"8px"}})])])])),64))])])):(l(),d("div",zt,[o.lectureList.length>0?(l(),d("ul",Qt,[(l(!0),d(S,null,w(o.lectureList,(a,y)=>(l(),d("li",{class:O(["class_item",n.timeCheck(a.fromTm,a.toTm).state]),key:y,onClick:B=>n.getLecture(a)},[e("div",Jt,[e("div",qt,[e("span",Kt,h(n.timeCheck(a.fromTm,a.toTm).text),1)]),e("div",Ut,[e("div",Xt," ( "+h(a.clsTm)+" ) "+h(a.openSbjtNo),1),e("div",Zt,h(a.sbjtNm)+" ("+h(a.sustNm)+")",1),e("div",ts,h(a.ltBldgNm)+" "+h(a.ltrmNm),1)])])],10,Gt))),128))])):(l(),d("ul",ss,os))]))])}const as=$(jt,[["render",ns]]);const cs={class:"attendance--main"},is={class:"app_container"},rs={class:"today_wapper"},ls={__name:"AttMain",setup(t){const s=K(),i=k("cont"),c=k("today"),o=k("list"),n=V("app-resume"),r=J(()=>s.state.signIn.user.sttsClsfCd==null?as:At);return U(()=>{c.value.rive(),o.value.getSemesterInfo(),n.on(()=>{c.value.rive(),o.value.refresh()})}),X(()=>{i.value.$el.scrollToPoint(0,0)}),Z(()=>{n.reset(),o.value.isLoading=!0}),(u,_)=>{const a=p("ion-content"),y=p("ion-page");return l(),b(y,null,{default:D(()=>[m(a,{fullscreen:!0,ref_key:"cont",ref:i},{default:D(()=>[e("div",cs,[e("div",is,[e("div",rs,[m(g(ht),{ref_key:"today",ref:c},null,512),(l(),b(q(r.value),{ref_key:"list",ref:o},null,512))])])])]),_:1},512)]),_:1})}}},Os=$(ls,[["__scopeId","data-v-3bb28414"]]);export{Os as default};
