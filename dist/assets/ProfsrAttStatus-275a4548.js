import{A as D,v as h,J as u,C as i,z as d,y as k,L as y,M as T,F as f,I as p,x as S,P,G as O,H as V,c as W,a as g,R as N}from"./@vue-ba2132af.js";import"./@rive-app-23332047.js";import"./lodash-c398c9e4.js";import{s as H,b as z,c as U,d as q,e as R,f as G,g as J}from"./TabMenu.vue_vue_type_style_index_0_scss_true_lang-0943e4ce.js";import{_ as b}from"./index-40f8ec66.js";import{a as C}from"./search-wifi-rcptn-hist-886e94a5.js";import{d as $}from"./dayjs-3dd13c04.js";import"./@awesome-cordova-plugins-365971a8.js";import"./@capacitor-6a3f6ab0.js";import{L as j,K as F,A as K}from"./@ionic-9d55a180.js";import{S as L}from"./search-eattd-open-sche-c974f3c2.js";import{S as v}from"./search-eattd-open-rpst-staff-info-133ce700.js";import{g as Q}from"./weekList-517d4bfd.js";import{c as A,b as x}from"./ionicons-2e812d46.js";import{a as X}from"./arrowDownIcon-a181db0e.js";import{c as Z,a as tt,l as et,r as st,_ as at}from"./TabMenu-208cb0cf.js";import{u as B}from"./vuex-d57e3de0.js";import{S as ot}from"./search-eattd-tlsn-std-info-6770e658.js";import"./vue-router-0104e6e6.js";import"./@vueuse-e4ab8daf.js";import"./axios-b6718f5e.js";import"./@stencil-18a6d1f6.js";import"./tslib-f1640d2e.js";import"./rxjs-6f486a4b.js";const Y=()=>{const t=document.querySelector('.alert-wrapper [aria-checked="true"]');t&&t.scrollIntoView()},nt={name:"profsr-att-status-table",components:{IonSelect:j,IonSelectOption:F},setup(){return{arrowDown:X,checkCircle:Z,cancelCircle:tt}},mounted(){window.addEventListener("ion-alert-did-present",Y)},unmounted(){window.removeEventListener("ion-alert-did-present",Y)},data(){return{closeCircleOutline:A,checkmarkCircleOutline:x,scheduleLine:[{day:"",timeline:["08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30","24:00"]},{day:"월",classList:[]},{day:"화",classList:[]},{day:"수",classList:[]},{day:"목",classList:[]},{day:"금",classList:[]},{day:"토",classList:[]}],termList:[],term:{},weekSize:0,classData:[],searchT:new L,searchL:new v,user:this.$store.state.signIn.user,weekData:{},selDay:C().checkDate,selWeek:"",today:C().checkDate}},computed:{thisWeekInfo(){try{const t=$(this.weekData[this.selWeek].startDate).add(1,"day").format("YYYY.MM.DD"),a=$(this.weekData[this.selWeek].endDate).format("MM.DD");return"".concat(t," ~ ").concat(a)}catch(t){return""}}},methods:{compareTerm(t,a){return t&&a?t.yy===a.yy&&t.shtmCd===a.shtmCd:!1},getClass(){this.classData=[],this.scheduleLine[1].classList=[],this.scheduleLine[2].classList=[],this.scheduleLine[3].classList=[],this.scheduleLine[4].classList=[],this.scheduleLine[5].classList=[],this.scheduleLine[6].classList=[],this.searchL.openYy=this.term.yy,this.searchL.ltStaffNo=this.user.mbrNo,this.searchL.openShtmCd=this.term.shtmCd,this.searchL.weekStartDate=this.weekData[this.selWeek].startDate,this.searchL.weekEndDate=this.weekData[this.selWeek].endDate;let t=[],a=[];this.$store.dispatch("profsr/getScheduleList",this.searchL).then(o=>{if(t=o.data.resultData,t=t.filter(e=>e.dayCd!=null&&e.dayCd!="CBA62.7"),t.find(e=>e.clsDivn==="Y")){for(let e=0;e<t.length;e++){let s=t[e];if(s.clsDivn==="Y")for(let r=0;r<s.timeList.length;r++){let l={openYy:s.openYy,openShtmCd:s.openShtmCd,shtmNm:s.shtmNm,openOrgnClsfCd:s.openOrgnClsfCd,openOrgnClsfNm:s.openOrgnClsfNm,openSust:s.openSust,sustNm:s.sustNm,openShyr:s.openShyr,openDclss:s.openDclss,pnt:s.pnt,openSbjtNo:s.openSbjtNo,sbjtNm:s.sbjtNm,ltStaffNo:s.ltStaffNo,staffNm:s.staffNm,dayCd:s.dayCd,dayNm:s.dayNm,fromTm:s.timeList[r][0],toTm:s.timeList[r][1],ltBldgCd:s.ltBldgCd,ltBldgNm:s.ltBldgNm,ltrmCd:s.ltrmCd,ltrmNm:s.ltrmNm,ltFromDt:s.ltFromDt,ltToDt:s.ltToDt,theoTmcnt:s.theoTmcnt,pracTmcnt:s.pracTmcnt,rpstProfYn:s.rpstProfYn,cptnDivNm:s.cptnDivNm,mthdCd:s.mthdCd,mthdNm:s.mthdNm,attYmd:s.attYmd,suppYn:s.suppYn,skpDt:s.skpDt,clsDivn:s.clsDivn,timeList:s.timeList};a.push(l)}else a.push(s)}a.sort((e,s)=>{if(s.dayCd==e.dayCd&&s.fromTm>e.fromTm)return-1}),this.classData=a.filter(e=>(e.ltFromDt<=this.weekData[this.selWeek].endDate&&e.ltFromDt>=this.weekData[this.selWeek].startDate||e.ltToDt<=this.weekData[this.selWeek].endDate&&e.ltToDt>=this.weekData[this.selWeek].startDate||e.ltToDt>this.weekData[this.selWeek].endDate&&e.ltFromDt<this.weekData[this.selWeek].startDate)&&this.findClsDate(e.dayCd)>=e.ltFromDt&&this.findClsDate(e.dayCd)<=e.ltToDt)}else this.classData=t.filter(e=>(e.ltFromDt<=this.weekData[this.selWeek].endDate&&e.ltFromDt>=this.weekData[this.selWeek].startDate||e.ltToDt<=this.weekData[this.selWeek].endDate&&e.ltToDt>=this.weekData[this.selWeek].startDate||e.ltToDt>this.weekData[this.selWeek].endDate&&e.ltFromDt<this.weekData[this.selWeek].startDate)&&this.findClsDate(e.dayCd)>=e.ltFromDt&&this.findClsDate(e.dayCd)<=e.ltToDt);this.clsDataPush()})},clsDataPush(){const t=o=>o.slice(0,2)+":"+o.slice(2,4),a={openYy:"",openShtmCd:"",shtmNm:"",openOrgnClsfCd:"",openOrgnClsfNm:"",openSust:"",sustNm:"",openShyr:"",openDclss:"",pnt:"",openSbjtNo:"not",sbjtNm:"",stdNo:"",stdNm:"",dayCd:"",dayNm:"",fromTm:"",toTm:"",ltBldgCD:"",ltBldgNm:"",ltrmCd:"",ltrmNm:"",retlsnYy:"",retlsnShtmNm:"",inout:"",staffNo:"",staffNm:"",mthdCd:"",mthdNm:"",attDiv:"",attPrcsDt:"",attYmd:"",skpDt:"",suppYn:"",clsDivn:"N",timeList:[]};this.classData.forEach((o,n)=>{for(let e=1;e<this.scheduleLine.length;e++){const s=this.scheduleLine[e],r=this.scheduleLine[0].timeline;if(o.dayNm==s.day)for(let l=0;l<r.length;l++)n>0&&this.classData[n-1].dayNm==o.dayNm?t(o.fromTm)>r[l]&&t(this.classData[n-1].fromTm)<r[l]?s.classList.push(a):t(o.fromTm)==r[l]&&s.classList.push(o):t(o.fromTm)>r[l]?s.classList.push(a):t(o.fromTm)==r[l]&&s.classList.push(o)}})},detail(t){if(t.openSbjtNo=="not")return;const a=new v;a.openSbjtNo=t.openSbjtNo,a.openDclss=t.openDclss,a.ltStaffNo=t.ltStaffNo,a.openYy=t.openYy,a.openShtmCd=t.openShtmCd,a.checkDate=this.findClsDate(t.dayCd),t.clsDivn?t.clsDivn==="N"?a.fromTm=t.fromTm:a.fromTm=t.timeList[0][0]:a.fromTm=t.fromTm,this.$store.commit("profsr/getLecture",a),this.$router.push("class")},clsHtml(t){const a=n=>n.slice(0,2)+":"+n.slice(2,4),o=(n,e)=>n.slice(0,3*e)+"...";if(t!=null){if(t.openSbjtNo=="not")return"";if(this.findClsDate(t.dayCd)<this.term.ltFromDt||this.findClsDate(t.dayCd)>this.term.ltToDt||t.ltFromDt<this.term.ltFromDt||t.ltToDt>this.term.ltToDt)return"";{const n=this.scheduleLine[0].timeline,e=n.indexOf(a(t.toTm))-n.indexOf(a(t.fromTm))+1;return new Date().getHours()>=t.toTm.substring(0,2)&&this.findClsDate(t.dayCd)==this.today||this.findClsDate(t.dayCd)<this.today?e>1?'<a><div class="tt__class time--'+e+' is--complete"><span class="class__infos">'+t.sbjtNm+"</span></div>	</a>":'<a><div class="tt__class time--'+e+' is--complete"><span>'+o(t.sbjtNm,e)+"</span></div>	</a>":e>1?'<a><div class="tt__class time--'+e+'"><span class="class__infos">'+t.sbjtNm+"</span></div>	</a>":'<a><div class="tt__class time--'+e+'"><span>'+o(t.sbjtNm,e)+"</span></div>	</a>"}}},getTermList(){this.searchT.orgnClsfCd="CBA01.020",this.searchT.yy=C().yy,this.$store.dispatch("common/getSemesterList",this.searchT).then(t=>{t.data.resultData&&(this.termList=t.data.resultData.reverse()),this.getThisTerm()})},getThisTerm(){const t=new L;t.yy=C().yy,t.checkDate=C().checkDate,this.$store.dispatch("common/getSemesterList",t).then(a=>{this.term=a.data.resultData[0],this.setWeekList()})},setWeekDay(t){this.selDay=this.weekData[t].startDate,this.selWeek=t,this.getClass(),this.getThisWeek()},setWeekList(){const t=this.term.ltFromDt,a=this.term.ltToDt;this.$store.dispatch("common/getWeekList",{ltFromDt:t,ltToDt:a}).then(o=>{this.weekData=o.data.resultData,this.weekSize=Object.keys(this.weekData),this.selDay==""?(this.setWeekDay(1),this.selWeek="1"):(this.weekSize.forEach(n=>{this.weekData[n].startDate<=this.selDay&&this.weekData[n].endDate>=this.selDay&&(this.selWeek=n)}),this.getClass(),this.getThisWeek()),this.$store.commit("common/setWeek",this.weekData[this.selWeek])})},changeTerm(t){this.term=t,this.weekData={},this.weekSize=[],this.selDay="",this.setWeekList(),this.$emit("updateTermValue",t)},getThisWeek(){const t=new Date(this.selDay.slice(0,4),this.selDay.slice(4,6)-1,this.selDay.slice(6));this.thisWeek=Q(t),this.$store.commit("common/setWeek",this.weekData[this.selWeek])},findClsDate(t){const a=t.replace("CBA62.","");return a==="7"?void 0:this.thisWeek[a].y+this.thisWeek[a].M+this.thisWeek[a].d}}},M=t=>(O("data-v-43290f19"),t=t(),V(),t),it={class:"section"},rt={class:"section"},lt={class:"guide"},ct={class:"list-style dot"},mt=M(()=>i("li",null,[f(" 과목 선택시 "),i("span",null,"출결 상세정보"),f("로 이동합니다. ")],-1)),ht={class:"time_table__semester"},dt={class:"week"},ut=M(()=>i("span",null,"기간",-1)),pt={class:"semester__time_table"},ft={class:"tt__cell tt__th"},Dt=["innerHTML","onClick"];function _t(t,a,o,n,e,s){const r=D("ion-select-option"),l=D("ion-select"),m=D("ion-icon");return h(),u(y,null,[i("section",it,[d(l,{value:e.term,toggleIcon:n.arrowDown,label:"학기",fill:"outline",placeholder:"학기 선택",compareWith:s.compareTerm,mode:"md",okText:"선택완료",cancelText:"닫기",onIonChange:a[0]||(a[0]=c=>s.changeTerm(c.detail.value))},{default:k(()=>[(h(!0),u(y,null,T(e.termList,(c,_)=>(h(),S(r,{key:"sche_".concat(_),value:c},{default:k(()=>[f(p(c.yy)+"년 "+p(c.shtmNm),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","toggleIcon","compareWith"]),d(l,{value:e.selWeek,toggleIcon:n.arrowDown,label:"주차",fill:"outline",placeholder:"주차 선택",mode:"md",okText:"선택완료",cancelText:"닫기",onIonChange:a[1]||(a[1]=c=>s.setWeekDay(c.detail.value))},{default:k(()=>[(h(!0),u(y,null,T(e.weekSize,(c,_)=>(h(),S(r,{key:"weekNum_".concat(_),value:c},{default:k(()=>[f(p(c)+"주차",1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","toggleIcon"])]),i("section",rt,[i("div",lt,[i("ul",ct,[i("li",null,[f(" 수업완료 : "),i("span",null,[d(m,{icon:n.checkCircle},null,8,["icon"]),f("(체크)")]),f(", 미수업 : "),i("span",null,[d(m,{icon:n.cancelCircle},null,8,["icon"]),f("(엑스)")])]),mt])]),i("div",ht,[i("div",dt,[ut,f(" "+p(s.thisWeekInfo),1)]),i("div",pt,[(h(!0),u(y,null,T(e.scheduleLine,(c,_)=>(h(),u("div",{class:"tt__row",key:_},[i("div",ft,p(c.day),1),(h(!0),u(y,null,T(e.scheduleLine[0].timeline,(E,w)=>(h(),u("div",{class:P(["tt__cell",{tt__th:c.timeline!=null}]),key:w,innerHTML:_==0?E:s.clsHtml(c.classList[w]),onClick:Ft=>s.detail(c.classList[w])},null,10,Dt))),128))]))),128))])])])],64)}const kt=b(nt,[["render",_t],["__scopeId","data-v-43290f19"]]),I=()=>{const t=document.querySelector('.alert-wrapper [aria-checked="true"]');t&&t.scrollIntoView()},Ct={name:"profsr-att-status-card",components:{IonSelect:j,IonSelectOption:F,IonDatetime:K},setup(){const t=B();return{status1:H,status2:z,status3:U,status4:q,status5:R,status6:G,status7:J,leftArrow:et,rightArrow:st,openDatePopup:()=>t.commit("dateSelectPopup/showDateSelectPopup",!0),decreaseDate:()=>t.commit("dateSelectPopup/decreaseDate"),increaseDate:()=>t.commit("dateSelectPopup/increaseDate")}},data(){const t=B(),a=W(()=>t.state.dateSelectPopup.date);return{formatDate:W(()=>t.state.dateSelectPopup.format),selectDate:a,closeCircleOutline:A,checkmarkCircleOutline:x,classData:[],user:this.$store.state.signIn.user}},mounted(){window.addEventListener("ion-alert-did-present",I),this.getCardList()},unmounted(){window.removeEventListener("ion-alert-did-present",I)},watch:{formatDate(){this.getCardList()}},methods:{getCardList(){const t=new L;t.yy=C().yy,t.orgnClsfCd="CBA01.020",this.$store.dispatch("common/getSemesterList",t).then(a=>{t.checkDate=C().checkDate,this.$store.dispatch("common/getSemesterInfo",t).then(o=>{const{resultData:n}=o.data;if(!n)return;const e=new ot,s=this.$store.state.dateSelectPopup.dateNumber.replaceAll(".","");e.ltStaffNo=this.user.mbrNo,e.openYy=this.$store.state.dateSelectPopup.date.getFullYear(),e.openShtmCd=n.shtmCd,e.weekStartDate=s,e.weekEndDate=s,e.searchDate=s,this.$store.dispatch("profsr/getScheduleCardList",e).then(r=>{const l=r.data.resultData;l&&(this.classData=l)})})})},detail(t){if(t.openSbjtNo=="not")return;const a=this.$store.state.dateSelectPopup.dateNumber.replaceAll(".",""),o=new v;o.openSbjtNo=t.openSbjtNo,o.openDclss=t.openDclss,o.ltStaffNo=t.ltStaffNo,o.openYy=t.openYy,o.openShtmCd=t.openShtmCd,o.dayCd=t.dayCd,o.sbjtNm=t.sbjtNm,o.checkDate=this.findClsDate(t.dayCd),t.clsDivn?t.clsDivn==="N"?o.fromTm=t.fromTm:o.fromTm=t.timeList[0][0]:o.fromTm=t.fromTm,this.$store.commit("common/setWeek",{startDate:a,endDate:a}),this.$store.commit("profsr/getLecture",o),this.$router.push("class")},findClsDate(t){return t.replace("CBA62.","")==="7"?void 0:this.$store.state.dateSelectPopup.dateNumber.replaceAll(".","")},timeCheck(t,a){const o=new Date,n=String(o.getHours()),e=o.getMinutes()<10?"0"+o.getMinutes():o.getMinutes(),s=Number(n+e),r=Number(t),l=Number(a);if(r>s)return{text:"수업전",state:"status4"};if(r<=s&&l>=s)return{text:"수업중",state:"status3"};if(l<s)return{text:"수업 완료",state:"status1"}}}},yt={class:"section"},Tt={class:"date_select_wrap"},wt={class:"section"},gt={key:0,class:"data-list"},Nt=["onClick"],St={class:"list-status"},Lt={class:"time"},vt={class:"class__state"},bt={class:"list-comment"},Wt={key:1,class:"non-data"};function $t(t,a,o,n,e,s){const r=D("ion-icon"),l=D("ion-button");return h(),u(y,null,[i("section",yt,[i("div",Tt,[d(l,{onClick:a[0]||(a[0]=m=>n.decreaseDate()),class:"arrow-btn"},{default:k(()=>[d(r,{src:n.leftArrow},null,8,["src"])]),_:1}),d(l,{onClick:a[1]||(a[1]=m=>n.openDatePopup())},{default:k(()=>[f(p(e.formatDate),1)]),_:1}),d(l,{onClick:a[2]||(a[2]=m=>n.increaseDate()),class:"arrow-btn"},{default:k(()=>[d(r,{src:n.rightArrow},null,8,["src"])]),_:1})])]),i("section",wt,[e.classData.length!==0?(h(),u("ul",gt,[(h(!0),u(y,null,T(e.classData,(m,c)=>(h(),u("li",{key:"status_".concat(c),class:"is--loading",onClick:_=>s.detail(m)},[i("div",St,[i("span",Lt,"("+p(m.clsTm)+") "+p(m.openSbjtNo),1),i("div",vt,[i("span",{class:P(["state",s.timeCheck(m.fromTm,m.toTm).state])},p(s.timeCheck(m.fromTm,m.toTm).text),3)])]),i("div",bt,[i("b",null,p(m.sbjtNm),1),i("p",null,p(m.ltBldgNm+" "+m.ltrmNm),1)])],8,Nt))),128))])):(h(),u("div",Wt,"수업이 없습니다."))])],64)}const Bt=b(Ct,[["render",$t]]),Yt={components:{ProfsrAttStatusTable:kt,ProfsrAttStatusCard:Bt,TabMenu:at},name:"profsr-att-status",props:["termValue"],data(){return{activeTabBtn:1}},methods:{ionViewWillEnter(){this.$store.state.common.termUpdate&&(this.$refs.table.selDay=C().checkDate,this.$refs.table.getTermList(),this.$store.commit("common/termUpdate",!1))},ionViewWillLeave(){this.activeTabBtn=1,this.$refs.cont.$el.scrollToPoint(0,0)},onChangeTabMenu(t){t!==this.activeTabBtn&&(this.activeTabBtn=t,this.ionViewWillEnter())},updateTermValue(t){this.termValue=t,this.$refs.table.term=t}}},It={class:"attendance--page"},Pt={class:"app_container"};function jt(t,a,o,n,e,s){const r=D("tab-menu"),l=D("profsr-att-status-table"),m=D("profsr-att-status-card"),c=D("ion-content"),_=D("ion-page");return h(),S(_,null,{default:k(()=>[d(c,{fullscreen:!0,ref:"cont"},{default:k(()=>[i("div",It,[i("div",Pt,[d(r,{activeTabBtn:e.activeTabBtn,onChange:s.onChangeTabMenu},null,8,["activeTabBtn","onChange"]),g(i("div",null,[d(l,{ref:"table",onUpdateTermValue:s.updateTermValue},null,8,["onUpdateTermValue"])],512),[[N,e.activeTabBtn===1]]),g(i("div",null,[g(d(m,null,null,512),[[N,t.activeTab2]])],512),[[N,e.activeTabBtn===2]])])])]),_:1},512)]),_:1})}const re=b(Yt,[["render",jt]]);export{re as default};
